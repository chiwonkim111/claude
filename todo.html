<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>To-Do</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f0f2f5;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 48px 16px;
    }

    .app {
      width: 100%;
      max-width: 520px;
    }

    h1 {
      font-size: 2rem;
      font-weight: 700;
      color: #1a1a2e;
      margin-bottom: 8px;
    }

    .subtitle {
      font-size: 0.875rem;
      color: #888;
      margin-bottom: 28px;
    }

    /* Input */
    .input-row {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }

    .input-row input {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      font-size: 0.95rem;
      outline: none;
      background: #fff;
      transition: border-color 0.2s;
    }

    .input-row input:focus { border-color: #6c63ff; }

    .input-row button {
      padding: 12px 20px;
      background: #6c63ff;
      color: #fff;
      border: none;
      border-radius: 12px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
    }

    .input-row button:hover { background: #574fd6; }
    .input-row button:active { transform: scale(0.96); }

    /* Filters */
    .filters {
      display: flex;
      gap: 6px;
      margin-bottom: 20px;
    }

    .filter-btn {
      padding: 6px 14px;
      border: none;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      background: #e8e8f0;
      color: #555;
      transition: all 0.2s;
    }

    .filter-btn.active {
      background: #6c63ff;
      color: #fff;
    }

    /* Stats */
    .stats {
      font-size: 0.8rem;
      color: #aaa;
      margin-left: auto;
      display: flex;
      align-items: center;
    }

    .filter-row {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    /* Task list */
    .task-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .task {
      display: flex;
      align-items: center;
      gap: 12px;
      background: #fff;
      border-radius: 12px;
      padding: 14px 16px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
      animation: slideIn 0.2s ease;
      transition: opacity 0.2s;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-8px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .task.done { opacity: 0.5; }

    /* Custom checkbox */
    .check-btn {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      border: 2px solid #ccc;
      background: transparent;
      cursor: pointer;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      font-size: 0.75rem;
      color: transparent;
    }

    .task.done .check-btn {
      background: #6c63ff;
      border-color: #6c63ff;
      color: #fff;
    }

    .task-text {
      flex: 1;
      font-size: 0.95rem;
      color: #1a1a2e;
      word-break: break-word;
      outline: none;
      cursor: text;
    }

    .task.done .task-text {
      text-decoration: line-through;
      color: #aaa;
    }

    .delete-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: #ccc;
      font-size: 1rem;
      padding: 4px;
      border-radius: 6px;
      transition: color 0.2s, background 0.2s;
      flex-shrink: 0;
    }

    .delete-btn:hover { color: #ff4d6d; background: #fff0f3; }

    /* Empty state */
    .empty {
      text-align: center;
      padding: 48px 0;
      color: #ccc;
      font-size: 0.9rem;
    }

    .empty-icon { font-size: 2.5rem; margin-bottom: 8px; }

    /* Clear completed */
    .clear-btn {
      display: none;
      margin-top: 16px;
      width: 100%;
      padding: 10px;
      background: none;
      border: 2px dashed #e0e0e0;
      border-radius: 12px;
      color: #aaa;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .clear-btn:hover { border-color: #ff4d6d; color: #ff4d6d; }
    .clear-btn.visible { display: block; }
  </style>
</head>
<body>
<div class="app">
  <h1>Ìï† Ïùº Î™©Î°ù</h1>
  <p class="subtitle" id="dateLabel"></p>

  <div class="input-row">
    <input type="text" id="taskInput" placeholder="ÏÉà Ìï† ÏùºÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." maxlength="200" />
    <button id="addBtn" title="Ï∂îÍ∞Ä">+</button>
  </div>

  <div class="filter-row">
    <div class="filters">
      <button class="filter-btn active" data-filter="all">Ï†ÑÏ≤¥</button>
      <button class="filter-btn" data-filter="active">ÏßÑÌñâ Ï§ë</button>
      <button class="filter-btn" data-filter="done">ÏôÑÎ£å</button>
    </div>
    <span class="stats" id="stats"></span>
  </div>

  <div class="task-list" id="taskList"></div>

  <button class="clear-btn" id="clearBtn">ÏôÑÎ£åÎêú Ìï≠Î™© Î™®Îëê ÏÇ≠Ï†ú</button>
</div>

<script>
  const STORAGE_KEY = 'todo_tasks_v1';
  let tasks = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
  let filter = 'all';

  // Date label
  const d = new Date();
  document.getElementById('dateLabel').textContent =
    d.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' });

  function save() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
  }

  function render() {
    const list = document.getElementById('taskList');
    const clearBtn = document.getElementById('clearBtn');
    const stats = document.getElementById('stats');

    const filtered = tasks.filter(t =>
      filter === 'all' ? true : filter === 'done' ? t.done : !t.done
    );

    const total = tasks.length;
    const doneCount = tasks.filter(t => t.done).length;
    stats.textContent = total ? `${doneCount}/${total} ÏôÑÎ£å` : '';
    clearBtn.classList.toggle('visible', doneCount > 0);

    if (filtered.length === 0) {
      list.innerHTML = `
        <div class="empty">
          <div class="empty-icon">${filter === 'done' ? '‚úÖ' : 'üìã'}</div>
          ${filter === 'done' ? 'ÏôÑÎ£åÎêú Ìï≠Î™©Ïù¥ ÏóÜÏäµÎãàÎã§.' : 'Ìï† ÏùºÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!'}
        </div>`;
      return;
    }

    list.innerHTML = '';
    filtered.forEach(task => {
      const el = document.createElement('div');
      el.className = 'task' + (task.done ? ' done' : '');
      el.dataset.id = task.id;
      el.innerHTML = `
        <button class="check-btn" data-action="toggle" title="ÏôÑÎ£å ÌÜ†Í∏Ä">‚úì</button>
        <span class="task-text" contenteditable="true" spellcheck="false">${escHtml(task.text)}</span>
        <button class="delete-btn" data-action="delete" title="ÏÇ≠Ï†ú">‚úï</button>
      `;

      // Inline edit
      const textEl = el.querySelector('.task-text');
      textEl.addEventListener('blur', () => {
        const newText = textEl.textContent.trim();
        if (newText) {
          task.text = newText;
          save();
        } else {
          textEl.textContent = task.text;
        }
      });
      textEl.addEventListener('keydown', e => {
        if (e.key === 'Enter') { e.preventDefault(); textEl.blur(); }
      });

      list.appendChild(el);
    });
  }

  function escHtml(str) {
    return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  }

  function addTask() {
    const input = document.getElementById('taskInput');
    const text = input.value.trim();
    if (!text) return;
    tasks.unshift({ id: Date.now(), text, done: false });
    save();
    render();
    input.value = '';
    input.focus();
  }

  // Event delegation on list
  document.getElementById('taskList').addEventListener('click', e => {
    const btn = e.target.closest('[data-action]');
    if (!btn) return;
    const id = +btn.closest('.task').dataset.id;
    const task = tasks.find(t => t.id === id);
    if (!task) return;

    if (btn.dataset.action === 'toggle') {
      task.done = !task.done;
      save();
      render();
    } else if (btn.dataset.action === 'delete') {
      tasks = tasks.filter(t => t.id !== id);
      save();
      render();
    }
  });

  document.getElementById('addBtn').addEventListener('click', addTask);
  document.getElementById('taskInput').addEventListener('keydown', e => {
    if (e.key === 'Enter') addTask();
  });

  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      filter = btn.dataset.filter;
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      render();
    });
  });

  document.getElementById('clearBtn').addEventListener('click', () => {
    tasks = tasks.filter(t => !t.done);
    save();
    render();
  });

  render();
</script>
</body>
</html>
